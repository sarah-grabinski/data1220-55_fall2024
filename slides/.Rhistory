function(x) dnorm(x, mean = 0.00005,
sd = 0.000003)),
d2 = sapply(seq(0.000001, 0.0001, by = 0.0000001),
function(x) dnorm(x, mean = 0.00001,
sd = 0.000000000003)),
min = 0)
df |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
ggplot(aes(x = x, y = d2)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d2),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nVaccinated Individuals 12+ in Denmark Oct '20-'21")
df <- data.frame(x = seq(0.0000075, 0.000075, by = 0.0000001),
d1 = sapply(seq(0.0000075, 0.000075, by = 0.0000001),
function(x) dnorm(x, mean = 0.00005,
sd = 0.000003)),
d2 = sapply(seq(0.0000075, 0.000075, by = 0.0000001),
function(x) dnorm(x, mean = 0.00001,
sd = 0.000000000003)),
min = 0)
df |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
ggplot(aes(x = x, y = d2)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d2),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nVaccinated Individuals 12+ in Denmark Oct '20-'21")
df <- data.frame(x = seq(0.0000075, 0.000075, by = 0.0000001),
d1 = sapply(seq(0.0000075, 0.000075, by = 0.0000001),
function(x) dnorm(x, mean = 0.00005,
sd = 0.000003)),
d2 = sapply(seq(0.0000075, 0.000075, by = 0.0000001),
function(x) dnorm(x, mean = 0.00001,
sd = 0.000000000003)),
min = 0)
df |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
ggplot(aes(x = x, y = d2)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d2),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nVaccinated Individuals 12+ in Denmark Oct '20-'21")
geom_line() +
geom_ribbon(aes(x = x2, ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
geom_line() +
geom_ribbon(aes(x = x2, ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
mutate(x2 = ifelse(x <= 0.00001, x, NA)) |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_vline(xintercept = 0.00001) +
geom_line() +
geom_ribbon(aes(x = x2, ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
mutate(x2 = ifelse(x >= 0.00015, x, NA)) |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_vline(xintercept = 0.00001) +
geom_line() +
geom_ribbon(aes(x = x2, ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_vline(xintercept = 0.00001) +
geom_line() +
geom_ribbon(aes(x = x2, ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_vline(xintercept = 0.00001, col = 'red') +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
df |>
ggplot(aes(x = x, y = d1)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_vline(xintercept = 0.00015, col = 'red') +
geom_line() +
geom_ribbon(aes(ymin = min, ymax = d1),
alpha = 0.5, fill = 'steelblue') +
labs(x = 'Sample Proportion',
y = 'Probability Density',
title = "Sampling Distribution for the Probability of Developing Myocarditis in\nIndividuals 12+ in Denmark Oct '20-'21")
pnorm(0.00001, mean = 0.00005, sd = 0.000003)
pnorm(0.00015, mean = 0.00005, sd = 0.000003)
pnorm(0.00015, mean = 0.00005, sd = 0.000003,
lower.tail = F)
df |>
tabyl(sex, reoffend) |>
vcd::mosaic()
df <- data.frame(id = sapply(seq(1, 73600),
function(x) paste('prisoner',
str_pad(x, width = 5,
side = 'left', pad = '0'),
sep = '')),
sex = c(rep('Male', 65504),
rep('Female', 8096)),
reoffend = c(rep('Rearrested', 28756),
rep('Not Rearrested', 36748),
rep('Rearrested', 2785),
rep('Not Rearrested', 5311))) |>
mutate(sex = fct_relevel(sex, 'Male'),
reoffend = fct_relevel(reoffend, 'Rearrested'))
df |>
tabyl(sex, reoffend) |>
vcd::mosaic()
df |>
ggplot() +
geom_mosaic(aes(x = product(sex, reoffend),
fill = reoffend))
install.packages("ggmosaic")
library(ggmosaic)
df |>
ggplot() +
geom_mosaic(aes(x = product(sex, reoffend),
fill = reoffend))
print(head(df))
print(df[sample(1:nrow(df), 1)])
sample(1:nrow(df), 1)
print(df[sample(1:nrow(df), 1), ])
print(df[sample(1:nrow(df), 6), ])
set.seed(123); lapply(1:100, function(x) {
sample <- rnorm(20, mean = 30, sd = 5)
mean <- mean(sample)
sd <- sd(sample)
return(data.frame(mean = mean, sd = sd))
}) |>
bind_rows(.id = 'iteration')
set.seed(123); dist <- lapply(1:100, function(x) {
sample <- rnorm(20, mean = 30, sd = 5)
mean <- mean(sample)
sd <- sd(sample)
return(data.frame(mean = mean, sd = sd))
}) |>
bind_rows(.id = 'iteration')
View(dist)
dist |>
ggplot(aes(x = mean)) +
geom_density(fill = 'steelblue', alpha = 0.5)
set.seed(123); dist <- lapply(1:10000, function(x) {
sample <- rnorm(20, mean = 30, sd = 5)
mean <- mean(sample)
sd <- sd(sample)
return(data.frame(mean = mean, sd = sd))
}) |>
bind_rows(.id = 'iteration')
dist |>
ggplot(aes(x = mean)) +
geom_density(fill = 'steelblue', alpha = 0.5)
dist |>
ggplot(aes(x = mean)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(dnorm,
args = list(mean = mean(dist$mean),
sd = sd(dist$mean) / sqrt(20)))
dist |>
ggplot(aes(x = mean)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = mean(dist$mean),
sd = sd(dist$mean) / sqrt(20)))
set.seed(123); dist <- lapply(1:10000, function(x) {
sample1 <- rnorm(20, mean = 30, sd = 5)
mean1 <- mean(sample1)
sd1 <- sd(sample1)
sample2 <- rnorm(30, mean = 30, sd = 5)
mean2 <- mean(sample2)
sd2 <- sd(sample2)
sample3 <- rnorm(50, mean = 30, sd = 5)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample3 <- rnorm(50, mean = 30, sd = 5)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample4 <- rnorm(100, mean = 30, sd = 5)
mean4 <- mean(sample4)
sd4 <- sd(sample4)
return(data.frame(mean1 = mean1, sd1 = sd1,
mean2 = mean2, sd2 = sd2,
mean3 = mean3, sd3 = sd3,
mean4 = mean4, sd4 = sd4))
}) |>
bind_rows(.id = 'iteration')
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = mean(dist$mean1),
sd = sd(dist$mean1)))
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = mean(dist$mean1),
sd = sd(dist$mean1)))
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(20)))
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(20)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(100)))
set.seed(123); dist <- lapply(1:1000, function(x) {
sample1 <- rnorm(20, mean = 30, sd = 5)
mean1 <- mean(sample1)
sd1 <- sd(sample1)
sample2 <- rnorm(30, mean = 30, sd = 5)
mean2 <- mean(sample2)
sd2 <- sd(sample2)
sample3 <- rnorm(50, mean = 30, sd = 5)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample3 <- rnorm(50, mean = 30, sd = 5)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample4 <- rnorm(100, mean = 30, sd = 5)
mean4 <- mean(sample4)
sd4 <- sd(sample4)
return(data.frame(mean1 = mean1, sd1 = sd1,
mean2 = mean2, sd2 = sd2,
mean3 = mean3, sd3 = sd3,
mean4 = mean4, sd4 = sd4))
}) |>
bind_rows(.id = 'iteration')
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(20)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(100)))
set.seed(123); dist <- lapply(1:1000, function(x) {
sample1 <- rnorm(20, mean = 30, sd = 5)
mean1 <- mean(sample1)
sd1 <- sd(sample1)
sample2 <- rnorm(30, mean = 30, sd = 5)
mean2 <- mean(sample2)
sd2 <- sd(sample2)
sample3 <- rnorm(50, mean = 30, sd = 5)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample3 <- rnorm(50, mean = 30, sd = 5)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample4 <- rnorm(100, mean = 30, sd = 5)
mean4 <- mean(sample4)
sd4 <- sd(sample4)
return(data.frame(mean1 = mean1, sd1 = sd1,
mean2 = mean2, sd2 = sd2,
mean3 = mean3, sd3 = sd3,
mean4 = mean4, sd4 = sd4))
}) |>
bind_rows(.id = 'iteration')
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(20)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(100)))
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(20)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(100)))
set.seed(123); dist <- lapply(1:1000, function(x) {
sample1 <- rnorm(20, mean = 30, sd = 10)
mean1 <- mean(sample1)
sd1 <- sd(sample1)
sample2 <- rnorm(30, mean = 30, sd = 10)
mean2 <- mean(sample2)
sd2 <- sd(sample2)
sample3 <- rnorm(50, mean = 30, sd = 10)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample4 <- rnorm(100, mean = 30, sd = 10)
mean4 <- mean(sample4)
sd4 <- sd(sample4)
return(data.frame(mean1 = mean1, sd1 = sd1,
mean2 = mean2, sd2 = sd2,
mean3 = mean3, sd3 = sd3,
mean4 = mean4, sd4 = sd4))
}) |>
bind_rows(.id = 'iteration')
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 5 / sqrt(20)))
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 10 / sqrt(20)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 10 / sqrt(100)))
set.seed(123); dist <- lapply(1:1000, function(x) {
sample1 <- rnorm(20, mean = 0, sd = 10)
mean1 <- mean(sample1)
sd1 <- sd(sample1)
sample2 <- rnorm(30, mean = 0, sd = 10)
mean2 <- mean(sample2)
sd2 <- sd(sample2)
sample3 <- rnorm(50, mean = 0, sd = 10)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample4 <- rnorm(100, mean = 0, sd = 10)
mean4 <- mean(sample4)
sd4 <- sd(sample4)
return(data.frame(mean1 = mean1, sd1 = sd1,
mean2 = mean2, sd2 = sd2,
mean3 = mean3, sd3 = sd3,
mean4 = mean4, sd4 = sd4))
}) |>
bind_rows(.id = 'iteration')
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 0,
sd = 10 / sqrt(20)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 0,
sd = 10 / sqrt(100)))
set.seed(123); dist <- lapply(1:1000, function(x) {
sample1 <- rnorm(10, mean = 30, sd = 10)
mean1 <- mean(sample1)
sd1 <- sd(sample1)
sample2 <- rnorm(20, mean = 30, sd = 10)
mean2 <- mean(sample2)
sd2 <- sd(sample2)
sample3 <- rnorm(30, mean = 30, sd = 10)
mean3 <- mean(sample3)
sd3 <- sd(sample3)
sample4 <- rnorm(400, mean = 30, sd = 10)
mean4 <- mean(sample4)
sd4 <- sd(sample4)
return(data.frame(mean1 = mean1, sd1 = sd1,
mean2 = mean2, sd2 = sd2,
mean3 = mean3, sd3 = sd3,
mean4 = mean4, sd4 = sd4))
}) |>
bind_rows(.id = 'iteration')
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 10 / sqrt(20)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 10 / sqrt(100)))
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 10 / sqrt(10)))
dist |>
ggplot(aes(x = mean4)) +
geom_density(fill = 'steelblue', alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 10 / sqrt(40)))
dist |>
ggplot() +
geom_density(aes(x = mean1),
fill = 'steelblue',
alpha = 0.5) +
stat_function(fun = dnorm,
args = list(mean = 30,
sd = 10 / sqrt(10)))
