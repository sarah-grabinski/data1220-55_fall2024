library(kableExtra)
library(tidyverse)
theme_set(theme_bw())
songs <- read_xlsx('./class08/Taylor Swift Radio.xlsx') |>
mutate(artists_split = str_split(artists, ', '))
songs_summary <- data.frame(artists = unlist(songs$artists_split)) |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor',
'Charli xcx'),
artists, 'Other')) |>
summarize(n = n(), proportion = n() / nrow(songs), .by = 'artists')
![***Sampling with replacement*** is like drawing a card from a deck, then shuffling it back in before drawing another card. Repetition is possible.]('/class09/Sampling With Replacement.png')
*   $\operatorname{Probability}=\operatorname{Proportion}$
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(lapply(seq(1, 10), \(x) paste('col', x, sep = '')), 4),
row = row_number()) |>
pivot_wider(names_from)
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(lapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = row_number()) |>
pivot_wider(names_from)
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(lapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = row_number()) |>
pivot_wider(names_from = 'column', values_from = 'artists')
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(lapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = row_number()) |>
pivot_wider(id_cols = 'row',
names_from = 'column',
values_from = 'artists')
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(lapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = rep(lapply(seq(1, 5),
\(x) paste('row', x, sep = '')), 10)) |>
pivot_wider(id_cols = 'row',
names_from = 'column',
values_from = 'artists')
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(sapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = rep(sapply(seq(1, 5),
\(x) paste('row', x, sep = '')), 10)) |>
pivot_wider(id_cols = 'row',
names_from = 'column',
values_from = 'artists')
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(sapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = rep(sapply(seq(1, 5),
\(x) paste('row', x, sep = '')), 10))
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(sapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = sapply(seq(1, 5), \(x) rep(x, 10)))
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(sapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = unlist(sapply(seq(1, 5), \(x) rep(x, 10))))
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(sapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = unlist(lapply(seq(1, 5), \(x) rep(x, 10))))
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(sapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = unlist(lapply(seq(1, 5), \(x) rep(x, 10))),
row = sapply(row, \(x) paste('row', x, sep = '')))
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(sapply(seq(1, 10),
\(x) paste('col', x, sep = '')), 5),
row = unlist(lapply(seq(1, 5), \(x) rep(x, 10))),
row = sapply(row, \(x) paste('row', x, sep = ''))) |>
pivot_wider(id_cols = 'row',
names_from = 'column',
values_from = 'artists')
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(seq(1, 10), 5),
row = unlist(lapply(seq(1, 5), \(x) rep(x, 10)))) |>
pivot_wider(id_cols = 'row',
names_from = 'column',
values_from = 'artists') |>
ggplot(aes())
songs |>
mutate(artists = str_wrap(artists, width = 15),
column = rep(seq(1, 10), 5),
row = unlist(lapply(seq(1, 5), \(x) rep(x, 10)))) |>
pivot_wider(id_cols = 'row',
names_from = 'column',
values_from = 'artists') |>
ggplot(aes(x = column, y = row)) +
geom_text(aes(label = artists, col = artists))
songs |>
ggplot(aes(y = name, fill = artists)) +
geom_bar() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(probability = 1 / 50) |>
ggplot(aes(x = probability, y = name, fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50) |>
ggplot(aes(x = probability,
y = reorder(name, artists),
fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50) |>
arrange(artists) |>
ggplot(aes(x = probability,
y = reorder(name, artists),
fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50, artists = as.factor(artists)) |>
ggplot(aes(x = probability,
y = reorder(name, artists),
fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50) |>
ggplot(aes(x = probability,
y = interact(artists, name),
fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50) |>
ggplot(aes(x = probability,
y = reorder(name, decreasing = T),
fill = factor(artists))) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50,
artists = fct_reorder(artists, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50,
artists = fct_reorder(artists, desc(artists)),
name = fct_reorder(name, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50,
artists = fct_reorder(artists, desc(artists)),
name = fct_reorder(name, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 10)) +
scale_x_continuous(limits = c(0, 1))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50,
artists = fct_reorder(artists, desc(artists)),
name = fct_reorder(name, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 10)) +
scale_x_continuous(limits = c(0, 0.1))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50,
artists = fct_reorder(artists, desc(artists)),
name = fct_reorder(name, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Song",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 10)) +
scale_x_continuous(limits = c(0, 0.05))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50,
artists = fct_reorder(artists, desc(artists)),
name = fct_reorder(name, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Song",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 10),
axis.text.y = element_text(size = 6)) +
scale_x_continuous(limits = c(0, 0.05))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
mutate(probability = 1 / 50,
artists = fct_reorder(artists, desc(artists)),
name = fct_reorder(name, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Song",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 6)) +
scale_x_continuous(limits = c(0, 0.05))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
summarize(n = n(), .by = 'artists') |>
mutate(probability = n / 50,
artists = fct_reorder(artists, desc(artists))) |>
ggplot(aes(x = probability,
y = name,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Song",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 6)) +
scale_x_continuous(limits = c(0, 0.05))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
summarize(n = n(), .by = 'artists') |>
mutate(probability = n / 50,
artists = fct_reorder(artists, desc(artists))) |>
ggplot(aes(x = probability,
y = artists,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Song",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 6)) +
scale_x_continuous(limits = c(0, 0.05))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
summarize(n = n(), .by = 'artists') |>
mutate(probability = n / 50,
artists = fct_reorder(artists, desc(artists))) |>
ggplot(aes(x = probability,
y = artists,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Song",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 6)) +
scale_x_continuous(limits = c(0, 1))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
summarize(n = n(), .by = 'artists') |>
mutate(probability = n / 50,
artists = fct_reorder(artists, desc(artists))) |>
ggplot(aes(x = probability,
y = artists,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Artist",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 10)) +
scale_x_continuous(limits = c(0, 0.5))
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other')) |>
summarize(n = n(), .by = 'artists') |>
mutate(probability = n / 50,
artists = fct_reorder(artists, desc(n))) |>
ggplot(aes(x = probability,
y = artists,
fill = factor(artists))) +
geom_col() +
labs(title = "Probability of Play by Artist",
subtitle = 'Total Songs = 50, Total artists = 26',
x = 'Proportion of Songs', y = 'Song Name') +
theme(axis.text.y = element_text(size = 10)) +
scale_x_continuous(limits = c(0, 0.5))
![](class10/complement.png)
pnorm(1, mean = 0, sd = 1)
pnorm(0.6, mean = 0, sd = 1)
pnorm(0.6, mean = 0, sd = 1, lower.tail = F)
pnorm(1, mean = 0, sd = 1, lower.tail = F)
1 - pnorm(1, mean = 0, sd = 1)
qnorm(0.6, mean = 0, sd = 1)
pnorm(1, mean = 0, sd = 1)
pnorm(0.6, mean = 0, sd = 1)
pam_mean <- 1500
pam_sd <- 300
pam_centered <- 1800 - pam_mean
pam_z <- pam_centered / pam_sd
pam_z
(1800 - 1500) / 300
