scale_x_continuous(breaks = seq(47.3, 76.1, by = 3.6))
#| fig.height: 4
data.frame(cmp_percent = seq(50, 80, by = 0.01)) |>
mutate(density = dnorm(cmp_percent, mean = 65.3, sd = 3.6),
x2 = ifelse(cmp_percent < 60.2,
cmp_percent, NA)) |>
ggplot() +
geom_hline(yintercept = 0) +
geom_ribbon(aes(x = x2, ymin = 0, ymax = density),
alpha = 0.5, fill = 'steelblue') +
geom_line(aes(x = cmp_percent, y = density)) +
geom_vline(xintercept = 60.2, linetype = 'dashed') +
labs(x = 'Completion Rate', y = 'Probability Density') +
scale_x_continuous(breaks = seq(47.3, 76.1, by = 3.6))
sqrt((0.242*(1-0.242))/298)
library(janitor)
library(tidyverse)
theme_set(theme_bw())
qnorm(0.05 / 2)
24.2 - qnorm(0.05 / 2) * 2.5
24.2 + qnorm(0.05 / 2) * 2.5
pnorm(-0.8, mean = 0, sd = 1) * 2
#| fig.height: 5.5
mean_x <- 24.2
se_x <- 2.5
data.frame(x = seq(mean_x - se_x*4,
mean_x + se_x*4, by = 0.01)) |>
mutate(density = dnorm(x, mean = mean_x, sd = se_x),
density2 = ifelse(x < qnorm(0.025, mean = mean_x, sd = se_x) |
x > qnorm(0.975, mean = mean_x, sd = se_x),
density, 0)) |>
ggplot() +
geom_hline(yintercept = 0) +
geom_ribbon(aes(x = x, ymin = 0, ymax = density2),
alpha = 0.5, fill = 'steelblue') +
geom_line(aes(x = x, y = density)) +
geom_vline(xintercept = 22.2, linetype = 'dashed') +
geom_point(aes(x = 7.06, y = 0), size = 5) +
geom_errorbar(aes(xmin = qnorm(0.025, mean = mean_x, sd = se_x),
xmax = qnorm(0.975, mean = mean_x, sd = se_x),
y = 0), width = 0.1, linewidth = 1) +
labs(x = 'Completion Rate', y = 'Probability Density') +
scale_x_continuous(breaks = seq(round(mean_x - se_x*12, 2),
round(mean_x + se_x*4, 2), by = se_x))
data.frame(x = seq(mean_x - se_x*4,
mean_x + se_x*4, by = 0.01)) |>
mutate(density = dnorm(x, mean = mean_x, sd = se_x),
density2 = ifelse(x < qnorm(0.025, mean = mean_x, sd = se_x) |
x > qnorm(0.975, mean = mean_x, sd = se_x),
density, 0)) |>
ggplot() +
geom_hline(yintercept = 0) +
geom_ribbon(aes(x = x, ymin = 0, ymax = density2),
alpha = 0.5, fill = 'steelblue') +
geom_line(aes(x = x, y = density)) +
geom_vline(xintercept = 22.2, linetype = 'dashed') +
geom_point(aes(x = 7.06, y = 0), size = 5) +
geom_errorbar(aes(xmin = qnorm(0.025, mean = mean_x, sd = se_x),
xmax = qnorm(0.975, mean = mean_x, sd = se_x),
y = 0), width = 0.01, linewidth = 1) +
labs(x = 'Completion Rate', y = 'Probability Density') +
scale_x_continuous(breaks = seq(round(mean_x - se_x*12, 2),
round(mean_x + se_x*4, 2), by = se_x))
data.frame(x = seq(mean_x - se_x*4,
mean_x + se_x*4, by = 0.01)) |>
mutate(density = dnorm(x, mean = mean_x, sd = se_x),
density2 = ifelse(x < qnorm(0.025, mean = mean_x, sd = se_x) |
x > qnorm(0.975, mean = mean_x, sd = se_x),
density, 0)) |>
ggplot() +
geom_hline(yintercept = 0) +
geom_ribbon(aes(x = x, ymin = 0, ymax = density2),
alpha = 0.5, fill = 'steelblue') +
geom_line(aes(x = x, y = density)) +
geom_vline(xintercept = 22.2, linetype = 'dashed') +
geom_point(aes(x = mean_x, y = 0), size = 5) +
geom_errorbar(aes(xmin = qnorm(0.025, mean = mean_x, sd = se_x),
xmax = qnorm(0.975, mean = mean_x, sd = se_x),
y = 0), width = 0.01, linewidth = 1) +
labs(x = 'Completion Rate', y = 'Probability Density') +
scale_x_continuous(breaks = seq(round(mean_x - se_x*12, 2),
round(mean_x + se_x*4, 2), by = se_x))
-   ***Positive:*** As $x \lim \infty$
nhanes_df <- NHANES
library(Hmisc)
library(NHANES)
library(tidyverse)
df <- read_csv('https://www.openintro.org/data/csv/babies.csv')
nhanes_df <- NHANES
nhanes_df |>
Hmisc::describe(birthweight)
nhanes_df |>
Hmisc::describe(bwt)
nhanes_df |>
Hmisc::describe('bwt')
nhanes_df |>
select(bwt) |>
Hmisc::describe() |>
html()
baby_df <- read_csv('https://www.openintro.org/data/csv/babies.csv')
baby_df |>
select(bwt) |>
Hmisc::describe() |>
html()
baby_df |>
Hmisc::describe() |>
html()
baby_df |>
select(bw) |>
Hmisc::describe() |>
html()
baby_df |>
ggplot(aes(x = bwt)) +
geom_histogram(binwidth = 1)
baby_df |>
ggplot(aes(x = bwt)) +
geom_histogram(binwidth = 2)
baby_df |>
select(bwt) |>
Hmisc::describe() |>
html()
baby_df |>
select(age) |>
Hmisc::describe() |>
html()
baby_df |>
select(smoke) |>
Hmisc::describe() |>
html()
baby_df |>
select(smoke) |>
Hmisc::describe() |>
html()
df |>
ggplot(aes(x = case,
y = age)) +
geom_point()
df |>
ggplot(aes(x = gestation,
y = age)) +
geom_point()
df |>
ggplot(aes(x = gestation,
y = age)) +
geom_point(col = 'steelblue', alpha = 0.5)
df |>
ggplot(aes(x = gestation,
y = age)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm')
df |>
ggplot(aes(x = gestation,
y = age)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = 'Length of Gestation (days)',
y = 'Age (years)',
title = 'Age in Years by Length of Gestation in Pregnant Women')
df |>
ggplot(aes(x = age,
y = height)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = 'Length of Gestation (days)',
y = 'Age (years)',
title = 'Age in Years by Length of Gestation in Pregnant Women')
View(baby_df)
baby_df |>
ggplot(aes(x = age,
y = height)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = 'Length of Gestation (days)',
y = 'Age (years)',
title = 'Age in Years by Length of Gestation in Pregnant Women')
df |>
ggplot(aes(x = age,
y = height)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Age (years)",
y = "Mother's Height (inches)",
title = 'Height in Inches by Age in Years of Mothers')
df |>
ggplot(aes(x = height,
y = weight)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Age (years)",
y = "Mother's Height (inches)",
title = 'Height in Inches by Age in Years of Mothers')
df |>
ggplot(aes(x = height,
y = weight)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches")
df |>
ggplot(aes(x = height,
y = weight)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between variables.',
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = age,
y = height)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'loess', col = 'red') +
labs(x = "Mother's Age (years)",
y = "Mother's Height (inches)",
title = 'Height in Inches by Age in Years of Mothers',
subtitle = 'This plot shows the relationship between two independent variables.')
df |>
ggplot(aes(x = age,
y = height)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'loess', col = 'red') +
labs(x = "Mother's Age (years)",
y = "Mother's Height (inches)",
title = 'Height in Inches by Age in Years of Mothers',
subtitle = 'This plot shows the relationship between two independent variables.',
caption = 'Red line = LOESS regression')
df |>
ggplot(aes(x = smoke,
y = gestation)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = smoke,
y = bwt)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = age,
y = gestation)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = weight,
y = gestation)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = height,
y = gestation)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = smoke,
y = weight)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = smoke,
y = age)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
)
caption = 'Red line = linear regression')
df |>
ggplot(aes(x = height,
y = weight)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'lm', col = 'red') +
labs(x = "Mother's Height (inches)",
y = "Mother's Weight (lbs)",
title = "Mother's Weight in Lbs by Height in Inches",
subtitle = 'This plot shows a positive association between two variables.',
caption = 'Red line = linear regression')
baby_df |>
ggplot(aes(x = age,
y = height)) +
geom_point(col = 'steelblue', alpha = 0.5) +
geom_smooth(method = 'loess', col = 'red') +
labs(x = "Mother's Age (years)",
y = "Mother's Height (inches)",
title = 'Height in Inches by Age in Years of Mothers',
subtitle = 'This plot shows the relationship between two independent variables.',
caption = 'Red line = LOESS regression')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = '',
title = 'Plot A')
library(Hmisc)
library(NHANES)
library(tidyverse)
baby_df <- read_csv('https://www.openintro.org/data/csv/babies.csv')
nhanes_df <- NHANES
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = '',
title = 'Plot A')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = 'Count',
title = 'Plot A')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Height)) +
geom_density() +
labs(y = '',
title = 'Plot B')
nhanes_df |>
ggplot(aes(x = Height)) +
geom_density() +
labs(y = 'Density',
title = 'Plot B',
subtitle = 'Density plot of Height')
library(patchwork)
nhanes_df |>
ggplot(aes(x = Pulse, y = 0)) +
geom_violin() +
labs(y = '', title = 'Plot C')
nhanes_df |>
mutate(density = dnorm(Pulse,
mean(nhanes_df$Pulse, na.rm = T), sd(nhanes_df$Pulse, na.rm = T))) |>
ggplot(aes(x = Pulse)) +
geom_violin(aes(y = 0)) +
labs(y = '', title = 'Plot C')
nhanes_df |>
mutate(
density = dnorm(Pulse,
mean(nhanes_df$Pulse, na.rm = T),
sd(nhanes_df$Pulse, na.rm = T)),
density2 = 0-density) |>
ggplot(aes(x = Pulse)) +
geom_ribbon(aes(ymin = density2,
ymax = density)) +
geom_violin(aes(y = 0)) +
labs(y = '', title = 'Plot C')
nhanes_df |>
mutate(
density = dnorm(Pulse,
mean(nhanes_df$Pulse, na.rm = T),
sd(nhanes_df$Pulse, na.rm = T)),
density2 = 0-density) |>
ggplot(aes(x = Pulse)) +
geom_ribbon(aes(ymin = density2,
ymax = density)) +
geom_violin(aes(y = 0), fill = NA) +
labs(y = '', title = 'Plot C')
p1 <- nhanes_df |>
ggplot(aes(x = Pulse)) +
geom_violin(aes(y = 0)) +
labs(y = '', title = 'Plot C')
p2 <- nhanes_df |>
ggplot(aes(x = BPDiaAve)) +
geom_density() +
labs(y = '', title = 'Plot D')
p1 + p2
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
geom_vline(xintercept = median(nhanes_df$Weight, na.rm = T),
col = 'blue') +
geom_vline(xintercept = mean(nhanes_df$Weight, na.rm = T),
col = 'orange') +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
geom_vline(xintercept = median(nhanes_df$Weight),
col = 'blue') +
geom_vline(xintercept = mean(nhanes_df$Weight),
col = 'orange') +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
geom_vline(xintercept = median(nhanes_df$Weight, na.rm = T),
col = 'blue') +
geom_vline(xintercept = mean(nhanes_df$Weight, na.rm = T),
col = 'orange') +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
set.seed(123); dist_df <- data.frame(
id = seq(1, 100),
uniform = c(unlist(lapply(0:10, function(x) rep(x, 8))),
sample(0:10, 12, replace = T)),
left_skew = sapply(seq(1, 100),
function(x) x^(1/3) * 2),
right_skew = sapply(seq(1, 100),
function(x) x^2/1000),
normal = abs(rnorm(100, mean = 5, sd = 2)),
bimodal = c(abs(rnorm(70, mean = 3, sd = 1)),
abs(rnorm(30, mean = 7, sd = 1))),
outlier = c(rpois(95, 3), sample(11:13, 5, replace = T))
)
set.seed(123); dist_df <- data.frame(
id = seq(1, 100),
uniform = c(unlist(lapply(0:10, function(x) rep(x, 8))),
sample(0:10, 12, replace = T)),
left_skew = sapply(seq(1, 100),
function(x) x^(1/3) * 2),
right_skew = sapply(seq(1, 100),
function(x) x^2/1000),
normal = abs(rnorm(100, mean = 5, sd = 2)),
bimodal = c(abs(rnorm(70, mean = 3, sd = 1)),
abs(rnorm(30, mean = 7, sd = 1))),
outlier = c(rpois(95, 3), sample(11:13, 5, replace = T))
)
p1 <- dist_df |>
ggplot(aes(x = bimodal, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot G')
p2 <- dist_df |>
ggplot(aes(x = left_skew, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot H')
p3 <- dist_df |>
ggplot(aes(x = normal, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot I')
p4 <- dist_df |>
ggplot(aes(x = outlier, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot J')
p5 <- dist_df |>
ggplot(aes(x = right_skew, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot K')
p6 <- dist_df |>
ggplot(aes(x = uniform, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot L')
patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6))
set.seed(123)
sample_sizes <- seq(1, 200, by = 1)
sample_df <- lapply(sample_sizes, function(x) {
df <- data.frame(artists = songs[sample(1:nrow(songs),
x, replace = T), ][['artists']]) |>
mutate(by_chappell = ifelse(artists == 'Chappell Roan', T, F)) |>
summarize(count = n(),
proportion = n() / x,
.by = 'by_chappell') |>
pivot_wider(names_from = 'by_chappell',
values_from = c('count', 'proportion'))
}) |>
bind_rows(.id = 'sample') |>
mutate(across(where(is.numeric), \(x) ifelse(is.na(x), 0, x)),
sample_size = as.numeric(sample))
