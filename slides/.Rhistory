y = "Mother's Height (inches)",
title = 'Height in Inches by Age in Years of Mothers',
subtitle = 'This plot shows the relationship between two independent variables.',
caption = 'Red line = LOESS regression')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = '',
title = 'Plot A')
library(Hmisc)
library(NHANES)
library(tidyverse)
baby_df <- read_csv('https://www.openintro.org/data/csv/babies.csv')
nhanes_df <- NHANES
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = '',
title = 'Plot A')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = 'Count',
title = 'Plot A')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Height)) +
geom_density() +
labs(y = '',
title = 'Plot B')
nhanes_df |>
ggplot(aes(x = Height)) +
geom_density() +
labs(y = 'Density',
title = 'Plot B',
subtitle = 'Density plot of Height')
library(patchwork)
nhanes_df |>
ggplot(aes(x = Pulse, y = 0)) +
geom_violin() +
labs(y = '', title = 'Plot C')
nhanes_df |>
mutate(density = dnorm(Pulse,
mean(nhanes_df$Pulse, na.rm = T), sd(nhanes_df$Pulse, na.rm = T))) |>
ggplot(aes(x = Pulse)) +
geom_violin(aes(y = 0)) +
labs(y = '', title = 'Plot C')
nhanes_df |>
mutate(
density = dnorm(Pulse,
mean(nhanes_df$Pulse, na.rm = T),
sd(nhanes_df$Pulse, na.rm = T)),
density2 = 0-density) |>
ggplot(aes(x = Pulse)) +
geom_ribbon(aes(ymin = density2,
ymax = density)) +
geom_violin(aes(y = 0)) +
labs(y = '', title = 'Plot C')
nhanes_df |>
mutate(
density = dnorm(Pulse,
mean(nhanes_df$Pulse, na.rm = T),
sd(nhanes_df$Pulse, na.rm = T)),
density2 = 0-density) |>
ggplot(aes(x = Pulse)) +
geom_ribbon(aes(ymin = density2,
ymax = density)) +
geom_violin(aes(y = 0), fill = NA) +
labs(y = '', title = 'Plot C')
p1 <- nhanes_df |>
ggplot(aes(x = Pulse)) +
geom_violin(aes(y = 0)) +
labs(y = '', title = 'Plot C')
p2 <- nhanes_df |>
ggplot(aes(x = BPDiaAve)) +
geom_density() +
labs(y = '', title = 'Plot D')
p1 + p2
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
geom_vline(xintercept = median(nhanes_df$Weight, na.rm = T),
col = 'blue') +
geom_vline(xintercept = mean(nhanes_df$Weight, na.rm = T),
col = 'orange') +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
geom_vline(xintercept = median(nhanes_df$Weight),
col = 'blue') +
geom_vline(xintercept = mean(nhanes_df$Weight),
col = 'orange') +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
geom_vline(xintercept = median(nhanes_df$Weight, na.rm = T),
col = 'blue') +
geom_vline(xintercept = mean(nhanes_df$Weight, na.rm = T),
col = 'orange') +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
nhanes_df |>
ggplot(aes(x = Weight)) +
geom_histogram(binwidth = 10) +
labs(y = 'Count',
title = 'Plot A',
subtitle = 'Histogram of Weight')
set.seed(123); dist_df <- data.frame(
id = seq(1, 100),
uniform = c(unlist(lapply(0:10, function(x) rep(x, 8))),
sample(0:10, 12, replace = T)),
left_skew = sapply(seq(1, 100),
function(x) x^(1/3) * 2),
right_skew = sapply(seq(1, 100),
function(x) x^2/1000),
normal = abs(rnorm(100, mean = 5, sd = 2)),
bimodal = c(abs(rnorm(70, mean = 3, sd = 1)),
abs(rnorm(30, mean = 7, sd = 1))),
outlier = c(rpois(95, 3), sample(11:13, 5, replace = T))
)
set.seed(123); dist_df <- data.frame(
id = seq(1, 100),
uniform = c(unlist(lapply(0:10, function(x) rep(x, 8))),
sample(0:10, 12, replace = T)),
left_skew = sapply(seq(1, 100),
function(x) x^(1/3) * 2),
right_skew = sapply(seq(1, 100),
function(x) x^2/1000),
normal = abs(rnorm(100, mean = 5, sd = 2)),
bimodal = c(abs(rnorm(70, mean = 3, sd = 1)),
abs(rnorm(30, mean = 7, sd = 1))),
outlier = c(rpois(95, 3), sample(11:13, 5, replace = T))
)
p1 <- dist_df |>
ggplot(aes(x = bimodal, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot G')
p2 <- dist_df |>
ggplot(aes(x = left_skew, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot H')
p3 <- dist_df |>
ggplot(aes(x = normal, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot I')
p4 <- dist_df |>
ggplot(aes(x = outlier, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot J')
p5 <- dist_df |>
ggplot(aes(x = right_skew, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot K')
p6 <- dist_df |>
ggplot(aes(x = uniform, y = '')) +
geom_boxplot() +
scale_x_continuous(breaks = seq(0, 15)) +
coord_cartesian(xlim = c(0, 13)) +
labs(x = '', y = '', title = 'Plot L')
patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6))
set.seed(123)
sample_sizes <- seq(1, 200, by = 1)
sample_df <- lapply(sample_sizes, function(x) {
df <- data.frame(artists = songs[sample(1:nrow(songs),
x, replace = T), ][['artists']]) |>
mutate(by_chappell = ifelse(artists == 'Chappell Roan', T, F)) |>
summarize(count = n(),
proportion = n() / x,
.by = 'by_chappell') |>
pivot_wider(names_from = 'by_chappell',
values_from = c('count', 'proportion'))
}) |>
bind_rows(.id = 'sample') |>
mutate(across(where(is.numeric), \(x) ifelse(is.na(x), 0, x)),
sample_size = as.numeric(sample))
sqrt((0.68*(1-0.68))/2027)
sqrt((0.68 * (1 - 0.68)) / 2027)
qnorm(0.975)
qnorm(0.975)*sqrt((0.68*(1-0.68))/2027)
qnorm(0.975) * sqrt((0.68 * (1 - 0.68)) / 2027)
sqrt((0.57 * (1 - 0.57)) / 2027)
sqrt((0.57 * (1 - 0.57)) / 2027)
qnorm(0.975) * sqrt((0.57 * (1 - 0.57)) / 2027)
(1155 / 2027) - qnorm(0.975) * sqrt((0.57 * (1 - 0.57)) / 2027)
(1155 / 2027) + qnorm(0.975) * sqrt((0.57 * (1 - 0.57)) / 2027)
(1155 / 2027) - qnorm(0.975) * sqrt((0.57 * (1 - 0.57)) / 2027)
(1155 / 2027) + qnorm(0.975) * sqrt((0.57 * (1 - 0.57)) / 2027)
pnorm(6.36, lower.tail = F)
pnorm(-6.36) + pnorm(6.36, lower.tail = F)
sqrt((0.75*(1-0.75))/1005 + (0.57*(1-0.57))/2027)
qnorm(0.975) * sqrt((0.75*(1-0.75))/1005 + (0.57*(1-0.57))/2027)
diff <- ((754 / 1005) - (1155 / 2027))
margin <- qnorm(0.975) * sqrt((0.57 * (1 - 0.57)) / 2027)
diff - margin
diff <- ((754 / 1005) - (1155 / 2027))
margin <- qnorm(0.975) * sqrt((0.57 * (1 - 0.57)) / 2027)
diff - margin
diff + margin
(754+1155)/(1005+2027)
diff <- ((754 / 1005) - (1155 / 2027))
margin <- qnorm(0.975) * sqrt((0.75*(1-0.75))/1005 + (0.57*(1-0.57))/2027)
diff - margin
diff + margin
sqrt((0.63*(1-0.63))/1005 + (0.63*(1-0.63))/2027)
0.750-0.570
/0.019
(0.750-0.570)/0.019
pnorm(-9.47) + pnorm(9.47, lower.tail = F)
sqrt((0.79*(1-0.79))/47 + (0.49*(1-0.49))/43)
sqrt((0.64*(1-0.64))/47 + (0.64*(1-0.64))/43)
106+159+100
385-142
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
opened = c(rep(T, 142),
rep(F, 243),
rep(T, 223),
rep(F, 392)))
df |>
tabyl(opened, bought)
library(janitor)
library(tidyverse)
df |>
tabyl(opened, bought)
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
opened = c(rep(T, 142),
rep(F, 243),
rep(T, 223),
rep(F, 392))) |>
mutate(bought = fct_relevel(bought, TRUE))
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
opened = c(rep(T, 142),
rep(F, 243),
rep(T, 223),
rep(F, 392))) |>
mutate(bought = fct_relevel(bought, 'TRUE'))
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
opened = c(rep(T, 142),
rep(F, 243),
rep(T, 223),
rep(F, 392))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'))
df |>
tabyl(opened, bought)
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
opened = c(rep(T, 142),
rep(F, 243),
rep(T, 223),
rep(F, 392))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'),
opened = fct_relevel(factor(opened), 'TRUE'))
df |>
tabyl(opened, bought)
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col'))
library(kableExtra)
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col')) |>
kbl() |>
kable_classic(full_width = F)
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
opened = c(rep(T, 142),
rep(F, 243),
rep(T, 223),
rep(F, 392))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'),
opened = fct_relevel(factor(opened), 'TRUE'))
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col')) |>
kbl() |>
kable_classic(full_width = F)
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col')) |>
kbl(caption = 'Purchases by Email Opens') |>
kable_classic(full_width = F)
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col')) |>
adorn_percentages(denominator = 'row') |>
kbl(caption = 'Purchases by Email Opens') |>
kable_classic(full_width = F)
243/635
142/365
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col')) |>
adorn_percentages() |>
kbl(caption = 'Purchases by Email Opens') |>
kable_classic(full_width = F)
0.365*0.385
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col')) |>
adorn_percentages() |>
kbl(caption = 'Purchases by Email Opens') |>
kable_classic(full_width = F)
159-107
385-107
1000-107-52-278
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
opened = c(rep(T, 107),
rep(F, 52),
rep(T, 278),
rep(F, 563))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'),
opened = fct_relevel(factor(opened), 'TRUE'))
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
linked = c(rep(T, 107),
rep(F, 52),
rep(T, 278),
rep(F, 563))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'),
linked = fct_relevel(factor(linked), 'TRUE'))
df |>
tabyl(linked, bought) |>
adorn_totals(where = c('row', 'col')) |>
kbl(caption = 'Purchases by Link Clicks') |>
kable_classic(full_width = F)
df <- data.frame(bought = c(rep(T, 159),
rep(F, 841)),
linked = c(rep(T, 107),
rep(F, 52),
rep(T, 278),
rep(F, 563))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'),
linked = fct_relevel(factor(linked), 'TRUE'))
df |>
tabyl(linked, bought) |>
adorn_totals(where = c('row', 'col')) |>
kbl(caption = 'Purchases by Link Clicks') |>
kable_classic(full_width = F)
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
linked = c(rep(T, 107),
rep(F, 52),
rep(T, 278),
rep(F, 563))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'),
linked = fct_relevel(factor(linked), 'TRUE'))
df |>
tabyl(linked, bought) |>
adorn_totals(where = c('row', 'col')) |>
kbl(caption = 'Purchases by Link Clicks') |>
kable_classic(full_width = F)
df <- data.frame(bought = c(rep(T, 385),
rep(F, 615)),
linked = c(rep(T, 107),
rep(F, 278),
rep(T, 52),
rep(F, 563))) |>
mutate(bought = fct_relevel(factor(bought), 'TRUE'),
linked = fct_relevel(factor(linked), 'TRUE'))
df |>
tabyl(linked, bought) |>
adorn_totals(where = c('row', 'col')) |>
kbl(caption = 'Purchases by Link Clicks') |>
kable_classic(full_width = F)
df |>
tabyl(opened, bought) |>
adorn_totals(where = c('row', 'col')) |>
adorn_percentages() |>
kbl(caption = 'Proportion of Purchases by Link Clicks') |>
kable_classic(full_width = F)
df |>
tabyl(linked, bought) |>
adorn_totals(where = c('row', 'col')) |>
adorn_percentages() |>
kbl(caption = 'Proportion of Purchases by Link Clicks') |>
kable_classic(full_width = F)
0.697*0.672
df <- data.frame(camps = c(rep('Y', 1328),
rep('N', 353),
rep('Y', 674),
rep('N', 761),
rep('Y', 408),
rep('N', 1445)),
party = c(rep('R', 1681),
rep('I', 1435),
rep('D', 1853)))
library(janitor)
library(tidyverse)
library(kableExtra)
df |>
tabyl(party, camps) |>
adorn_totals(where = c('row', 'col')) |>
kbl() |>
kable_classic(full_width = F)
df <- data.frame(camps = c(rep('Y', 1328),
rep('N', 353),
rep('Y', 674),
rep('N', 761),
rep('Y', 408),
rep('N', 1445)),
party = c(rep('R', 1681),
rep('I', 1435),
rep('D', 1853))) |>
mutate(party = fct_relevel(factor(party), 'R', 'I'),
camps = fct_relevel(factor(camps), 'Y'))
df |>
tabyl(party, camps) |>
adorn_totals(where = c('row', 'col')) |>
kbl() |>
kable_classic(full_width = F)
df <- data.frame(camps = c(rep('Y', 1328),
rep('N', 353),
rep('Y', 674),
rep('N', 761),
rep('Y', 408),
rep('N', 1445),
rep('Y', 105),
rep('N', 278)),
party = c(rep('R', 1681),
rep('I', 1435),
rep('D', 1853),
rep(NA, 383))) |>
mutate(party = fct_relevel(factor(party), 'R', 'I'),
camps = fct_relevel(factor(camps),))
df <- data.frame(camps = c(rep('Y', 1328),
rep('N', 353),
rep('Y', 674),
rep('N', 761),
rep('Y', 408),
rep('N', 1445),
rep('Y', 105),
rep('N', 278)),
party = c(rep('R', 1681),
rep('I', 1435),
rep('D', 1853),
rep(NA, 383))) |>
mutate(party = fct_relevel(factor(party), 'R', 'I', 'D'),
camps = fct_relevel(factor(camps),))
df <- data.frame(camps = c(rep('Y', 1328),
rep('N', 353),
rep('Y', 674),
rep('N', 761),
rep('Y', 408),
rep('N', 1445),
rep('Y', 105),
rep('N', 278)),
party = c(rep('R', 1681),
rep('I', 1435),
rep('D', 1853),
rep(NA, 383))) |>
mutate(party = fct_relevel(factor(party), 'R', 'I', 'D'),
camps = fct_relevel(factor(camps), 'Y'))
df |>
tabyl(party, camps) |>
adorn_totals(where = c('row', 'col')) |>
kbl() |>
kable_classic(full_width = F)
df |>
tabyl(party, camps) |>
adorn_totals(where = c('row', 'col')) |>
kbl() |>
kable_classic(full_width = F)
df |>
tabyl(party, camps) |>
adorn_totals(where = c('row', 'col')) |>
adorn_percentages(denominator = 'row') |>
kbl() |>
kable_classic(full_width = F)
df |>
tabyl(party, camps) |>
adorn_totals(where = c('row', 'col')) |>
kbl() |>
kable_classic(full_width = F)
df |>
tabyl(party, camps) |>
adorn_totals(where = c('row', 'col')) |>
adorn_percentages(denominator = 'col') |>
kbl() |>
kable_classic(full_width = F)
pchisq(2, df = 3)
0.02/qnorm(0.975)
qnorm(0.975)
0.02/qnorm(0.975)
0.02/qnorm(0.975)^2
(0.02/qnorm(0.975))^2
(0.52*(1-0.52))/(0.02/qnorm(0.975))^2
