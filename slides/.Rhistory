filter(col != 'Other', n > 1) |>
ggplot(aes(x = n, y = reorder(col, n, max), fill = reorder(col, n))) +
geom_col() +
# facet_grid(rows = vars(sample), scales = 'free', space = 'free') +
facet_grid(cols = vars(sample), scales = 'free', space = 'free') +
labs(x = 'Number of Songs', y = 'Artist',
title = 'Number of Songs by Artist in 10 Plays',
subtitle = 'n = 6')
repeat_df <- lapply(rep(10, 20), function(x) {
df <- data.frame(artists = songs[sample(1:nrow(songs),
x, replace = T), ][['artists']],
song = lapply(seq(1, 10),
function(x) str_pad(x, width = 2,
side = 'left', pad = '0')))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(col = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = n(),
proportion = n() / 10,
.by = c('sample', 'col'))
df <- data.frame(artists = unlist(songs[sample(1:nrow(songs),
x, replace = T),
][['artists_split']]))
repeat_df <- lapply(rep(10, 20), function(x) {
df <- data.frame(artists = unlist(songs[sample(1:nrow(songs),
x, replace = T),
][['artists_split']]))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(col = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = n(),
proportion = n() / 10,
.by = c('sample', 'col'))
repeat_df |>
mutate(n = as.factor(n))
df <- data.frame(artists = unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split']))
repeat_df <- lapply(rep(10, 20), function(x) {
df <- data.frame(artists = unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split']))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(col = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = n(),
proportion = n() / 10,
.by = c('sample', 'col'))
repeat_df |>
mutate(n = as.factor(n)) |>
ggplot(aes(x = sample, y = col, fill = n)) +
geom_tile()
repeat_df |>
# mutate(n = as.factor(n)) |>
ggplot(aes(x = sample, y = col, fill = n)) +
geom_tile()
repeat_df |>
mutate(n = as.factor(n)) |>
ggplot(aes(x = sample, y = col, fill = n)) +
```
repeat_df |>
mutate(n = as.factor(n)) |>
ggplot(aes(x = sample, y = col, fill = n)) +
geom_tile()
repeat_df |>
ggplot(aes(x = sample, y = col, fill = n)) +
geom_tile()
repeat_df <- lapply(rep(10, 20), function(x) {
df <- data.frame(artists = unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split']))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(artist = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = n(),
proportion = n() / 10,
.by = c('sample', 'artist'))
repeat_df |>
mutate(artist = str_replace_all(artist, ' ', '\n')) |>
ggplot(aes(x = n, y = reorder(sample, n, max), fill = reorder(artist, n))) +
geom_col() +
# facet_grid(rows = vars(sample), scales = 'free', space = 'free') +
facet_grid(cols = vars(artist), scales = 'free', space = 'free') +
labs(x = 'Number of Songs', y = 'Artist',
title = 'Number of Songs by Artist in 10 Plays',
subtitle = 'n = 6')
repeat_df |>
mutate(artist = str_replace_all(artist, ' ', '\n'))
repeat_df |>
mutate(artist = str_replace_all(artist, ' ', '\n')) |>
ggplot(aes(x = n, y = reorder(sample, n, max), fill = reorder(artist, n)))
repeat_df |>
ggplot(aes(x = n)) +
geom_histogram()
repeat_df |>
ggplot(aes(x = n)) +
geom_histogram(binwidth = 1)
repeat_df |>
ggplot(aes(x = n, fill = artist)) +
geom_histogram(binwidth = 1) +
facet_grid(cols = vars(artist))
repeat_df |>
ggplot(aes(x = n, fill = artist)) +
geom_histogram(binwidth = 1) +
facet_grid(cols = vars(artist)) +
guides(fill = 'none')
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_histogram(binwidth = 1) +
guides(fill = 'none')
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_histogram(binwidth = 1) +
guides(fill = 'none') +
facet_grid(cols = vars(artist))
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_histogram(binwidth = 1, col = 'white') +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
labs(x = 'Count of Samples', y = 'Number of Times Played')
set.seed(123)
repeat_df <- lapply(rep(10, 50), function(x) {
df <- data.frame(artists = unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split']))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(artist = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = n(),
proportion = n() / 10,
.by = c('sample', 'artist'))
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_histogram(binwidth = 1, col = 'white') +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
labs(x = 'Count of Samples', y = 'Number of Times Played')
+
geom_col() +
# facet_grid(rows = vars(sample), scales = 'free', space = 'free') +
facet_grid(cols = vars(artist), scales = 'free', space = 'free') +
labs(x = 'Number of Songs', y = 'Artist',
title = 'Number of Songs by Artist in 10 Plays',
subtitle = 'n = 6')
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
labs(x = 'Count of Samples', y = 'Number of Times Played',
title = 'Number of Times Artist is Played in 10 Songs',
subtitle = 'n = 50')
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
labs(x = 'Count of Samples', y = 'Number of Times Played',
title = 'Number of Times Artist is Played in 10 Songs',
subtitle = 'n = 50')
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(1, 10)) +
labs(x = 'Count of Samples', y = 'Number of Times Played',
title = 'Number of Times Artist is Played in 10 Songs',
subtitle = 'n = 50')
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Count of Samples', y = 'Number of Times Played',
title = 'Number of Times Artist is Played in 10 Songs',
subtitle = 'n = 50')
df <- data.frame(artists = songs_summary$artists) |>
mutate(n = sapply(artists, function(x) sum(artists_sampled == x)))
repeat_df <- lapply(rep(10, 50), function(x) {
artists_sampled <- unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split'])
df <- data.frame(artists = songs_summary$artists) |>
mutate(n = sapply(artists, function(x) sum(artists_sampled == x)))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(artist = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = n(),
proportion = n() / 10,
.by = c('sample', 'artist'))
repeat_df <- lapply(rep(10, 50), function(x) {
artists_sampled <- unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split'])
df <- data.frame(artists = songs$artists) |>
mutate(n = sapply(artists, function(x) sum(artists_sampled == x)))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(artist = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = sum(n),
proportion = sum(n) / 10,
.by = c('sample', 'artist'))
repeat_df <- lapply(rep(10, 50), function(x) {
artists_sampled <- unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split'])
df <- data.frame(artists = unique(songs$artists)) |>
mutate(n = sapply(artists, function(x) sum(artists_sampled == x)))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(artist = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = sum(n),
proportion = sum(n) / 10,
.by = c('sample', 'artist'))
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Count of Samples', y = 'Number of Times Played',
title = 'Number of Times Artist is Played in 10 Songs',
subtitle = 'n = 50')
save.image("~/john-carroll/data1220/slides/.RData")
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other'),
artists = str_replace_all(artists,
c(', ' = ',\n',
'Del Rey' = '\nDel Rey',
'Chappell Roan' = 'Chappell\nRoan',
'Meghan Trainor' = 'Meghan\nTrainor'))) |>
summarize(n = n(), .by = artists) |>
ggplot(aes(x = reorder(artists, n),
y = n, fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist')
songs |>
mutate(artists = ifelse(artists %in% c('Taylor Swift',
'Chappell Roan',
'Billie Eilish',
'Adele',
'Lana Del Rey',
'Meghan Trainor') |
str_detect(artists, 'Charli'),
artists, 'Other'),
artists = str_replace_all(artists,
c(', ' = ',\n',
'Del Rey' = '\nDel Rey',
'Chappell Roan' = 'Chappell\nRoan',
'Meghan Trainor' = 'Meghan\nTrainor'))) |>
summarize(n = n(), .by = artists) |>
ggplot(aes(x = reorder(artists, n),
y = n, fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(title = "Number of Songs on the 'Taylor Swift Radio' playlist\non Spotify by Artist(s)",
subtitle = 'Total artists = 26',
x = 'Artist(s)', y = 'Count of Songs on Playlist') +
theme(axis.text.x = element_text(size = 10))
repeat_df |>
ggplot(aes(y = proportion, fill = artist)) +
geom_hline(yintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50')
.by = c('artist')
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist'))
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n'))
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
ggplot(aes(x = proportion, y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50')
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
ggplot(aes(x = proportion, y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50')
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
ggplot(aes(x = proportion, y = factor(n), fill = artist)) +
geom_hline(yintercept = 0) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50')
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
ggplot(aes(x = proportion, y = factor(n), fill = artist)) +
geom_hline(yintercept = 0) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
# scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50')
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
ggplot(aes(x = proportion, y = factor(n), fill = artist)) +
geom_hline(yintercept = 0) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
# scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50') +
theme(axis.text.x = element_text(size = 8))
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
ggplot(aes(x = proportion, y = factor(n), fill = artist)) +
geom_hline(yintercept = 0) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
# scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50') +
theme(axis.text.x = element_text(size = 6))
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
ggplot(aes(x = proportion, y = factor(n), fill = artist)) +
geom_hline(yintercept = 0) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
# scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50') +
theme(axis.text.x = element_text(size = 5))
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
mutate(artist = str_replace_all(artist, ' ', '\n')) |>
ggplot(aes(x = proportion, y = factor(n), fill = artist)) +
geom_hline(yintercept = 0) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
# scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50') +
theme(axis.text.x = element_text(size = 5))
songs_summary |>
mutate(artists = str_replace_all(artists,
c(', ' = ',\n',
'Del Rey' = '\nDel Rey',
'Chappell Roan' = 'Chappell\nRoan',
'Meghan Trainor' = 'Meghan\nTrainor'))) |>
mutate(prop = n / 50) |>
ggplot(aes(x = reorder(artists, prop),
y = prop, fill = artists)) +
geom_col() +
guides(fill = 'none') +
labs(x = 'Artist', y = 'Proportion',
title = 'Proportion of Songs by Artist on Taylor Swift Radio',
subtitle = 'n = 50')
set.seed(123)
repeat_df <- lapply(rep(10, 50), function(x) {
artists_sampled <- unlist(songs[sample(1:nrow(songs),
x, replace = T),
'artists_split'])
df <- data.frame(artists = unique(songs$artists)) |>
mutate(n = sapply(artists, function(x) sum(artists_sampled == x)))
}) |>
bind_rows(.id = 'sample') |>
mutate(sample = lapply(sample,
function(x) str_pad(x, width = 2,
side = 'left', pad = '0'))) |>
mutate(artist = ifelse(artists %in% songs_summary$artists,
artists, 'Other')) |>
summarize(n = sum(n),
proportion = sum(n) / 10,
.by = c('sample', 'artist'))
repeat_df |>
ggplot(aes(y = n, fill = artist)) +
geom_hline(yintercept = 0) +
geom_histogram(binwidth = 1, col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
scale_y_continuous(breaks = seq(0, 10)) +
coord_cartesian(ylim = c(0, NA)) +
labs(x = 'Count of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50')
## Calculating the Population Probability for a Single Event ($p=\operatorname{Probability}(\operatorname{Next Song by Chappell Roan})$)
repeat_df |>
summarize(proportion = n() / 50,
.by = c('artist', 'n')) |>
mutate(artist = str_replace_all(artist, ' ', '\n')) |>
ggplot(aes(x = proportion, y = factor(n), fill = artist)) +
geom_col(col = 'white') +
geom_vline(xintercept = 0) +
guides(fill = 'none') +
facet_grid(cols = vars(artist)) +
# scale_y_continuous(breaks = seq(0, 10)) +
labs(x = 'Proportion of 10-Song Samples', y = 'Number of Times Played',
title = 'Distribution of the Number of Times an Artist is Played in 10 Songs',
subtitle = 'n = 50') +
theme(axis.text.x = element_text(size = 5))
